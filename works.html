<div class="slickBox" >
    <span class="pre" style="display: none;">←</span>
    <div class="test" style="width: 100vw;">
    </div>
    <span class="next">→</span>
</div>

<script>
    // let works;

    $.get('worksData.json', {}, (e) => {
        works = e.worksListData[nowWorks]
        console.log(works,nowWorks);

        for (let i = 0; i < works.length; i++) {
            $('.test').append(`
        <div class="work d-flex" style="">
            <div class="idNum">no.${works.length-i}</div>
            <img class="workImg fire" id="${i}" src="${works[i].id_cover}">
            <div class="title" >${works[i].title}</div>
            <small class="year">${works[i].year}</small>
        </div>
        `)
            $('.current').text('1')
            $('.count').text(works.length)
        }
        slickInit('.test')
        // $(`.slick-slide[data-slick-index="1"]`).css('left','-5rem');
    
        function slickInit(who) {
            $(who).slick({
                centerMode: true,
                centerPadding: '60px',
                dots: true,
                lazyLoad: 'ondemand',
                slidesToShow: 3,
                slidesToScroll: 3,
                // autoplay: true,
                // autoplaySpeed: 5000,
                arrows: false,
                accessibility: false,
                infinite:false,
                focusOnSelect: true,
                responsive: [
                    {
                    breakpoint: 992,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                    }
                ]
            });
            $(who).on('afterChange', () => {
                let id = $(who).slick('slickCurrentSlide')
                if(id!==0) {
                    $(`.work`).parents(`.slick-slide[data-slick-index="${id-1}"]`).animate({'right':'-5rem'},300)
                }
                if(id!==works.length) {
                    $(`.work`).parents(`.slick-slide[data-slick-index="${id+1}"]`).animate({'left':'-5rem'},300)
                }
            })
            $('.pre').click(() => {
                $(who).slick('slickPrev')
                let id = $(who).slick('slickCurrentSlide')

                $(`.work`).parents(`.slick-slide[data-slick-index="${id}"]`).animate({'right':'0'},300)
                $(`.work`).parents(`.slick-slide[data-slick-index="${id+2}"]`).animate({'right':'0rem'},300)

                $(`.work`).parents(`.slick-slide`).css({'left':'','right':''})
                if(id!==0) {
                    $(`.work`).parents(`.slick-slide[data-slick-index="${id-1}"]`).animate({'right':'-5rem'},300)
                }else{
                    $('.pre').hide()
                }
                if(id!==works.length) {
                    if($('.next').css('display')=='none') $('.next').show()
                    $(`.work`).parents(`.slick-slide[data-slick-index="${id+1}"]`).animate({'left':'-5rem'},300)
                }
            })
            $('.next').click(() => {
                $(who).slick('slickNext')
                let id = $(who).slick('slickCurrentSlide')
                
                $(`.work`).parents(`.slick-slide[data-slick-index="${id}"]`).animate({'left':'0'},300)
                $(`.work`).parents(`.slick-slide[data-slick-index="${id-2}"]`).animate({'right':'0'},300)
                $(`.work`).parents(`.slick-slide`).css({'left':'','right':''})
                if(id!==0) {
                    if($('.pre').css('display')=='none') $('.pre').show()
                    $(`.work`).parents(`.slick-slide[data-slick-index="${id-1}"]`).animate({'right':'-5rem'},300)
                }
                if(id!==works.length) {
                    $(`.work`).parents(`.slick-slide[data-slick-index="${id+1}"]`).animate({'left':'-5rem'},300)
                }else{
                    $('.next').hide()
                }
            })

            $('.fire').click((event) => {
                // let id = $(who).slick('slickGetOption');
                let id = event.target.id;
                console.log(id);
                
                // let s = workData[nowWorks][id]
                // console.log(s);

                $('.fire').parents('.works').append(`
                <div class="modal fade " id="work" tabindex="-1" >
                    <div class="modal-dialog modal-lg border-0" >
                        <div class="modal-content border-0" id="imgs">
                        </div>
                    </div>
                    <div class="tags">
                            <ul>
                            </ul>
                        </div>
                        <div class="workTitle">${works[id].title}</div>
                        <div class="close">
                            <img src="./images/close-24px.svg" style="transform: scale(1.3);">
                        </div>
                        <div class="idNum">
                            <div>${works.length-id}</div>
                            <div>${works.length}</div>
                        </div>
                </div>`)

                for (let j = 0; j < works[id].imgs.length; j++) {
                    $('#imgs').append(`
                        <img data-index="${nowWorks}" src="${works[id].imgs[j]}">
                    `)
                    
                }

                const tags = works[id].tags.split(" ")
                // console.log(tags);
                for (let k = 0; k < tags.length; k++) {
                    $('.tags ul').append(`<li>${tags[k]}</li>`)
                }

                // console.log(works[id].imgs[0]);
                
                $('#work').modal()
                $('#work').on('hidden.bs.modal', function (e) {
                    $('#work').remove();
                })
            })
        }

    })



</script>